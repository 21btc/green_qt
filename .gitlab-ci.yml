stages:
  - lint
  - depends
  - build

.depends:
  stage: depends
  script:
    - tools/builddeps.sh

.build:
  stage: build
  variables:
    GIT_SUBMODULE_STRATEGY: recursive
  script:
    - depends/bin/qt-cmake -DGREEN_ENV=Testing -DGREEN_BUILD_ID=-$CI_COMMIT_SHORT_SHA .
    - cat config.h
    - make -j

include:
  - local: 'ci/*.yml'
